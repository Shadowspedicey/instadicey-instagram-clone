(this["webpackJsonpinstagram-clone"]=this["webpackJsonpinstagram-clone"]||[]).push([[0],{232:function(e,t){},234:function(e,t){},247:function(e,t){},249:function(e,t){},277:function(e,t){},279:function(e,t){},280:function(e,t){},285:function(e,t){},287:function(e,t){},293:function(e,t){},295:function(e,t){},314:function(e,t){},326:function(e,t){},329:function(e,t){},390:function(e,t,s){},391:function(e,t,s){},392:function(e,t,s){},397:function(e,t,s){},398:function(e,t,s){},399:function(e,t,s){},400:function(e,t,s){},401:function(e,t,s){"use strict";s.r(t);var c=s(1),a=s.n(c),n=s(48),r=s.n(n),o=s(10),i=s(6),l=s(95);var A=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"START_LOADING":return!0;case"STOP_LOADING":return!1;default:return e}};var d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return t.payload;case"SIGN_OUT":return null;default:return e}},j=s(13);const u={message:"Empty",severity:"success",open:!1};var h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SNACKBAR":return{message:t.payload.message,severity:t.payload.severity,open:!0};case"OPEN_SNACKBAR":return Object(j.a)(Object(j.a)({},e),{},{open:!0});case"CLOSE_SNACKBAR":return Object(j.a)(Object(j.a)({},e),{},{open:!1});default:return e}};var m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NEW_POST":return t.payload.file;default:return e}};var b=Object(l.a)({loading:A,currentUser:d,snackbar:h,newPost:m});var O=Object(l.b)(b,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__({trace:!0})),x=s(7),p=s(425),f=s(427),v=s(422);const g=e=>({type:"SET_CURRENT_USER",payload:e});var w=s(40),N=s.n(w);const y=(e,t)=>({type:"SET_SNACKBAR",payload:{message:e,severity:t}});var S=s(213),k=s.n(S),C=s(63);const E=e=>({type:"SET_NEW_POST",payload:{file:e}});var z=s.p+"static/media/namelogo.37ef1c08.png",P=s.p+"static/media/logo.d4e48eb0.png",T=s.p+"static/media/loading.42aaa181.jpg";const D="http://localhost:5000",I=async()=>{try{return(await fetch("".concat(D,"/ping"),{method:"GET",mode:"cors"})).ok}catch(e){return!1}},R=async(e,t)=>{e({type:"START_LOADING"}),localStorage.removeItem("token"),e(g(null)),t.push("/"),e({type:"STOP_LOADING"})},B=async(e,t)=>{const s=await fetch("".concat(D,"/auth/login/refresh?rt=").concat(encodeURIComponent(localStorage.refreshToken)),{method:"POST"});if(!s.ok)return R(e,t);const c=await s.json();localStorage.token=c.token,localStorage.refreshToken=c.refreshToken;const a=N.a.decode(c.token);e(g(a))};var L=s(0);const U=()=>{const e=Object(i.b)(),t=Object(x.useHistory)(),[s,a]=Object(c.useState)(!1),[n,r]=Object(c.useState)([]),[l,A]=Object(c.useState)([]),[d,j]=Object(c.useState)(!1),[u,h]=Object(c.useState)(""),m=async()=>{if(!localStorage.token)return A(n);try{a(!0);const s=await fetch("".concat(D,"/user/get-search"),{headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===s.status)return R(e,t);s.ok&&A(await s.json()),a(!1)}catch(s){e(y("Oops, try again later.","error"))}},b=s=>{j(!1),h(""),(async s=>{localStorage.token?401===(await fetch("".concat(D,"/user/add-search/").concat(s.username),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}})).status&&R(e,t):r([s,...n])})(s)};return Object(L.jsx)(k.a,{onOutsideClick:()=>j(!1),children:Object(L.jsxs)("div",{className:"searchbar-container",children:[Object(L.jsx)("input",{className:"search",placeholder:"Search",onFocus:()=>{j(!0),""===u&&m()},onChange:async t=>{const s=t.target.value;if(h(s),""===s)return m();a(!0);try{const e=await fetch("".concat(D,"/user/search?username=").concat(s));e.ok&&A(await e.json())}catch(c){e(y("Oops, try again later.","error"))}a(!1)},value:u}),d?Object(L.jsxs)("div",{children:[Object(L.jsx)("span",{className:"arrow"}),Object(L.jsxs)("ul",{className:"search-list outlined",children:[""!==u||s?null:Object(L.jsxs)("div",{className:"recent",children:["Recent",localStorage.token&&Object(L.jsx)("button",{className:"text",onClick:async()=>{try{const s=await fetch("".concat(D,"/user/clear-search"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===s.status)return R(e,t);if(!s.ok)throw new Error;A([])}catch(s){e(y("Oops, try again later.","error"))}},children:"Clear All"})]}),s?Object(L.jsx)("div",{className:"loading",children:Object(L.jsx)("img",{src:T,alt:"loading..."})}):l.map((s=>Object(L.jsx)("li",{children:Object(L.jsxs)(o.b,{to:"/".concat(s.username),onClick:()=>b(s),children:[Object(L.jsx)("div",{className:"img-container outlined round",children:Object(L.jsx)("img",{src:s.profilePic,alt:"".concat(s.username,"'s Profile Pic'")})}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsxs)("div",{style:{display:"flex"},children:[Object(L.jsx)("span",{className:"username",children:s.username})," ",s.isVerified?Object(L.jsx)("div",{className:"verified",title:"Verified"}):null]}),Object(L.jsx)("span",{className:"real-name",children:s.realName})]}),""===u&&Object(L.jsx)("div",{className:"remove",onClick:c=>(async(s,c)=>{if(s.stopPropagation(),s.preventDefault(),!localStorage.token){const e=n.filter((e=>e.username!==c));return A(e),r(e)}if(401===(await fetch("".concat(D,"/user/remove-search/").concat(c),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}})).status)return R(e,t);await m()})(c,s.username),children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:Object(L.jsx)("path",{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"})})})]})},s.username)))]})]}):null]})})};var M=()=>{const e=Object(x.useHistory)(),t=Object(x.useLocation)(),s=Object(i.b)(),a=Object(c.useRef)(),n=Object(i.c)((e=>e.currentUser)),[r,l]=Object(c.useState)(!1),[A,d]=Object(c.useState)(!1),j=Object(C.useMediaQuery)({query:"(max-width: 600px)"}),u=e=>{e.stopPropagation(),d(!0),setTimeout((()=>{l(!1),d(!1)}),125)};return Object(L.jsxs)("nav",{id:"main-navbar",children:[Object(L.jsx)("div",{className:"logo",children:Object(L.jsx)(o.b,{to:"/",children:Object(L.jsx)("img",{src:j?P:z,alt:"Instadicey"})})}),Object(L.jsx)("li",{children:Object(L.jsx)(U,{})}),n?Object(L.jsxs)("ul",{children:[Object(L.jsx)("li",{children:Object(L.jsx)("button",{className:"add-post icon",onClick:()=>a.current.click(),children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M13 2v9h9v2h-9v9h-2v-9h-9v-2h9v-9h2zm2-2h-6v9h-9v6h9v9h6v-9h9v-6h-9v-9z"})})})}),Object(L.jsx)("input",{accept:".png, .jpg, .jpeg",type:"file",ref:a,onChange:t=>{const c=t.target.files[0];a.current.value=null,s(E(c)),e.push("/create/style")}}),Object(L.jsx)("li",{children:Object(L.jsx)(o.b,{to:"/",className:"icon",children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:"/"===t.pathname?Object(L.jsx)("path",{d:"M21 13v10h-6v-6h-6v6h-6v-10h-3l12-12 12 12h-3zm-1-5.907v-5.093h-3v2.093l3 3z"}):Object(L.jsx)("path",{d:"M20 7.093v-5.093h-3v2.093l3 3zm4 5.907l-12-12-12 12h3v10h7v-5h4v5h7v-10h3zm-5 8h-3v-5h-8v5h-3v-10.26l7-6.912 7 6.99v10.182z"})})})}),"guest"!==n.username&&Object(L.jsx)("li",{children:Object(L.jsx)(o.b,{to:"/direct/inbox",className:"icon",children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:t.pathname.includes("/direct/")?Object(L.jsx)("path",{d:"M12 12.713l-11.985-9.713h23.97l-11.985 9.713zm0 2.574l-12-9.725v15.438h24v-15.438l-12 9.725z"}):Object(L.jsx)("path",{d:"M0 3v18h24v-18h-24zm21.518 2l-9.518 7.713-9.518-7.713h19.036zm-19.518 14v-11.817l10 8.104 10-8.104v11.817h-20z"})})})}),Object(L.jsxs)("li",{className:"profile",onClick:()=>l(!0),children:[Object(L.jsx)("div",{className:"icon",children:Object(L.jsx)("img",{src:n.profilePic,alt:"Profile Pic"})}),r&&Object(L.jsxs)("div",{children:[Object(L.jsx)("div",{className:"dropdown-container",onClick:u}),Object(L.jsxs)("div",{className:"dropdown outlined ".concat(A?"closed":""),children:[Object(L.jsx)("span",{className:"arrow"}),Object(L.jsxs)("ul",{children:[Object(L.jsx)("li",{children:Object(L.jsxs)(o.b,{to:"/".concat(n.username),onClick:u,children:[Object(L.jsx)("svg",{className:"icon",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M12 0c6.623 0 12 5.377 12 12s-5.377 12-12 12-12-5.377-12-12 5.377-12 12-12zm8.127 19.41c-.282-.401-.772-.654-1.624-.85-3.848-.906-4.097-1.501-4.352-2.059-.259-.565-.19-1.23.205-1.977 1.726-3.257 2.09-6.024 1.027-7.79-.674-1.119-1.875-1.734-3.383-1.734-1.521 0-2.732.626-3.409 1.763-1.066 1.789-.693 4.544 1.049 7.757.402.742.476 1.406.22 1.974-.265.586-.611 1.19-4.365 2.066-.852.196-1.342.449-1.623.848 2.012 2.207 4.91 3.592 8.128 3.592s6.115-1.385 8.127-3.59zm.65-.782c1.395-1.844 2.223-4.14 2.223-6.628 0-6.071-4.929-11-11-11s-11 4.929-11 11c0 2.487.827 4.783 2.222 6.626.409-.452 1.049-.81 2.049-1.041 2.025-.462 3.376-.836 3.678-1.502.122-.272.061-.628-.188-1.087-1.917-3.535-2.282-6.641-1.03-8.745.853-1.431 2.408-2.251 4.269-2.251 1.845 0 3.391.808 4.24 2.218 1.251 2.079.896 5.195-1 8.774-.245.463-.304.821-.179 1.094.305.668 1.644 1.038 3.667 1.499 1 .23 1.64.59 2.049 1.043z"})}),"Profile"]})}),Object(L.jsx)("li",{children:Object(L.jsxs)(o.b,{to:"/".concat(n.username,"/saved"),onClick:u,children:[Object(L.jsx)("svg",{className:"icon",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M5 0v24l7-6 7 6v-24h-14zm1 1h12v20.827l-6-5.144-6 5.144v-20.827z"})}),"Saved"]})}),Object(L.jsx)("li",{children:Object(L.jsxs)(o.b,{to:"/accounts/edit",onClick:u,children:[Object(L.jsx)("svg",{className:"icon",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M12 8.666c-1.838 0-3.333 1.496-3.333 3.334s1.495 3.333 3.333 3.333 3.333-1.495 3.333-3.333-1.495-3.334-3.333-3.334m0 7.667c-2.39 0-4.333-1.943-4.333-4.333s1.943-4.334 4.333-4.334 4.333 1.944 4.333 4.334c0 2.39-1.943 4.333-4.333 4.333m-1.193 6.667h2.386c.379-1.104.668-2.451 2.107-3.05 1.496-.617 2.666.196 3.635.672l1.686-1.688c-.508-1.047-1.266-2.199-.669-3.641.567-1.369 1.739-1.663 3.048-2.099v-2.388c-1.235-.421-2.471-.708-3.047-2.098-.572-1.38.057-2.395.669-3.643l-1.687-1.686c-1.117.547-2.221 1.257-3.642.668-1.374-.571-1.656-1.734-2.1-3.047h-2.386c-.424 1.231-.704 2.468-2.099 3.046-.365.153-.718.226-1.077.226-.843 0-1.539-.392-2.566-.893l-1.687 1.686c.574 1.175 1.251 2.237.669 3.643-.571 1.375-1.734 1.654-3.047 2.098v2.388c1.226.418 2.468.705 3.047 2.098.581 1.403-.075 2.432-.669 3.643l1.687 1.687c1.45-.725 2.355-1.204 3.642-.669 1.378.572 1.655 1.738 2.1 3.047m3.094 1h-3.803c-.681-1.918-.785-2.713-1.773-3.123-1.005-.419-1.731.132-3.466.952l-2.689-2.689c.873-1.837 1.367-2.465.953-3.465-.412-.991-1.192-1.087-3.123-1.773v-3.804c1.906-.678 2.712-.782 3.123-1.773.411-.991-.071-1.613-.953-3.466l2.689-2.688c1.741.828 2.466 1.365 3.465.953.992-.412 1.082-1.185 1.775-3.124h3.802c.682 1.918.788 2.714 1.774 3.123 1.001.416 1.709-.119 3.467-.952l2.687 2.688c-.878 1.847-1.361 2.477-.952 3.465.411.992 1.192 1.087 3.123 1.774v3.805c-1.906.677-2.713.782-3.124 1.773-.403.975.044 1.561.954 3.464l-2.688 2.689c-1.728-.82-2.467-1.37-3.456-.955-.988.41-1.08 1.146-1.785 3.126"})}),"Settings"]})}),Object(L.jsx)("li",{className:"log-out",onClick:()=>{R(s,e)},children:"Log Out"})]})]})]})]})]}):Object(L.jsx)("div",{children:Object(L.jsx)("button",{style:{fontSize:"1rem",padding:"0.5rem 0.75rem"},onClick:async()=>{try{s({type:"START_LOADING"});const e=await fetch("".concat(D,"/auth/login"),{method:"POST",body:JSON.stringify({email:"guest@instadicey.com",password:""}),headers:{"Content-Type":"application/json"}}),t=await e.json();if(!e.ok)throw new Error(t.detail,{cause:t.errors});localStorage.setItem("token",t.token),localStorage.setItem("refreshToken",t.refreshToken);const c=N.a.decode(t.token);s(g(c))}catch(e){console.error(e)}s({type:"STOP_LOADING"})},children:"Continue as guest"})})]})};var Q=()=>Object(L.jsx)("div",{className:"loading-page",children:Object(L.jsx)("div",{className:"loading",children:Object(L.jsx)("img",{src:P,alt:"Logo"})})}),G=s(423);var F=e=>Object(L.jsx)("div",{style:{whiteSpace:"pre-line"},className:"error-msg",children:e.text}),H=s.p+"static/media/email-verification.ef786c0a.png";var Z=()=>{const e=Object(c.useRef)(),t=Object(c.useRef)(),s=Object(c.useRef)(),a=Object(c.useRef)(),n=Object(x.useHistory)(),r=Object(i.b)(),[l,A]=Object(c.useState)(!1),[d,j]=Object(c.useState)(!1),[u,h]=Object(c.useState)(null);Object(c.useEffect)((()=>document.title="Sign Up \u2022 Instadicey"),[]);const m=()=>{!(()=>{const t=e.current.value.trim();return""!==t&&!!t.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)})()||a.current.value.length<6||s.current.value.length>20||0===s.current.value.length||!s.current.value.match(/^[A-Za-z0-9]*$/)?A(!1):A(!0)};return Object(c.useEffect)((()=>r({type:"STOP_LOADING"})),[r]),d?Object(L.jsxs)("div",{id:"email-verification-window",className:"outlined",children:[Object(L.jsx)("div",{className:"icon",children:Object(L.jsx)("img",{src:H,alt:"email verification icon"})}),Object(L.jsx)("p",{className:"header",children:"A verification link has been sent to your email"}),Object(L.jsx)("p",{children:"Please click on the link sent to your email address and come back here to continue."})]}):Object(L.jsxs)("div",{id:"signup-page",children:[Object(L.jsxs)("div",{id:"signup-window",className:"outlined",children:[Object(L.jsx)("div",{className:"logo",children:Object(L.jsx)("img",{src:z,alt:"Instadicey logo"})}),u?Object(L.jsx)(F,{text:u}):Object(L.jsx)("span",{style:{fontWeight:"bold",color:"rgba(50, 50, 50, 0.5)"},children:"Sign up now!"}),Object(L.jsxs)("form",{className:"info",onSubmit:async c=>{if(!await I())return h("Server is down."),void r(y("Server is down.","error"));if(c.preventDefault(),!l)return;h(null);const o=e.current.value.toLowerCase(),i=t.current.value,A=s.current.value.toLowerCase(),d=a.current.value;try{r({type:"START_LOADING"});const e={email:o,username:A,realName:i,password:d},t=await fetch("".concat(D,"/auth/register"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"},mode:"cors"});if(!t.ok){const e=await t.json();throw new Error(e.detail,{cause:e.errors})}j(!0);const s=(new G.a).withUrl("".concat(D,"/email-verification-hub")).withAutomaticReconnect().build();await s.start(),await s.invoke("RegisterUserWithEmail",o),s.on("VerifyEmail",(async()=>{r({type:"START_LOADING"});const e=await fetch("".concat(D,"/auth/login"),{method:"POST",body:JSON.stringify({email:o,password:d}),headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json();localStorage.setItem("token",t.token),localStorage.setItem("refreshToken",t.refreshToken);const s=N.a.decode(t.token);r(g(s))}n.push("/"),r({type:"STOP_LOADING"})}))}catch(b){var u;const e=null!==(u=b.cause)&&void 0!==u?u:[],t=[];for(var m=0;m<e.length;m++)"DuplicateUserName"===e[m].code?t.push("Username already in use."):"DuplicateEmail"===e[m].code&&t.push("Email already in use.");0===e.length?h("An error has occurred."):h(t.join("\n"))}r({type:"STOP_LOADING"})},children:[Object(L.jsx)("input",{type:"text",placeholder:"Email",id:"email",ref:e,onChange:m}),Object(L.jsx)("input",{type:"text",placeholder:"Full Name",id:"name",ref:t}),Object(L.jsx)("input",{type:"text",placeholder:"Username",id:"username",ref:s,onChange:m}),Object(L.jsx)("input",{type:"password",placeholder:"Password",id:"password",ref:a,onChange:m}),Object(L.jsx)("button",{id:"signup",className:"".concat(l?null:"disabled"),children:"Sign Up"})]})]}),Object(L.jsx)("div",{className:"extra outlined",children:Object(L.jsxs)("span",{children:["Have an account? ",Object(L.jsx)(o.b,{to:"/",className:"button",children:"Log In"})]})})]})},W=s.p+"static/media/green-checkmark.6fb350c8.png";var X=()=>{const e=Object(i.b)(),t=Object(i.c)((e=>e.currentUser)),s=Object(c.useRef)(),[a,n]=Object(c.useState)(!1),[r,l]=Object(c.useState)(!1),[A,d]=Object(c.useState)(null);Object(c.useEffect)((()=>document.title="Reset Password \u2022 Instadicey"),[]),Object(c.useEffect)((()=>{localStorage.removeItem("token"),e(g(null))}),[e]);const j=()=>{const e=s.current.value;return""===e?n(!1):e.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)?n(!0):n(!1)},u=async t=>{if(t.preventDefault(),!a)return;const c=s.current.value;e({type:"START_LOADING"});try{d(null);const e=encodeURIComponent(c),t=await fetch("".concat(D,"/auth/send-password-reset?email=").concat(e),{method:"POST"});if(!t.ok){const e=await t.json();throw new Error(e.detail)}l(!0)}catch(r){var n;d(null!==(n=r.message)&&void 0!==n?n:"An error occurred")}e({type:"STOP_LOADING"})};return r?Object(L.jsxs)("div",{className:"password-reset-window success outlined",children:[Object(L.jsx)("div",{className:"icon",children:Object(L.jsx)("img",{src:W,alt:"Success"})}),Object(L.jsx)("h1",{children:"Email sent"}),Object(L.jsx)("p",{children:"Check your inbox and spam and follow the instructions"}),Object(L.jsx)("div",{className:"extra",children:Object(L.jsx)(o.b,{to:"/",children:"Back To Login"})})]}):Object(L.jsxs)("div",{className:"password-reset-window outlined",children:[Object(L.jsx)("div",{className:"icon",children:Object(L.jsx)("img",{src:"data:image/png;base64,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",alt:"locked out"})}),Object(L.jsx)("h1",{children:"Can't Log In?"}),Object(L.jsx)("p",{children:"It's all good, mate. just enter your email and we'll send you an email to reset your password right away!"}),A?Object(L.jsx)(F,{text:A}):null,Object(L.jsxs)("form",{onSubmit:u,children:[Object(L.jsx)("input",{type:"text",id:"email",placeholder:"Email",ref:s,onChange:j}),Object(L.jsx)("button",{id:"reset",className:"".concat(a?null:"disabled"),children:"Send Email"})]}),!t&&Object(L.jsx)("div",{className:"extra outlined",children:Object(L.jsx)(o.b,{to:"/",children:"Back To Login"})})]})};s(390);var J=()=>{const e=Object(c.useRef)(),t=Object(c.useRef)(),s=Object(i.b)(),[a,n]=Object(c.useState)(!1),[r,l]=Object(c.useState)(null);Object(c.useEffect)((()=>document.title="Login \u2022 Instadicey"),[]);const A=()=>{!(()=>{const t=e.current.value;return""!==t&&!!t.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/)})()||t.current.value.length<6?n(!1):n(!0)};return Object(c.useEffect)((()=>s({type:"STOP_LOADING"})),[s]),Object(L.jsxs)("div",{id:"login-page",children:[Object(L.jsxs)("div",{id:"login-window",className:"outlined",children:[Object(L.jsx)("div",{className:"logo",children:Object(L.jsx)("img",{src:z,alt:"Instadicey logo"})}),r?Object(L.jsx)(F,{text:r}):null,Object(L.jsxs)("form",{className:"info",onSubmit:async c=>{if(c.preventDefault(),!a)return;const n=e.current.value,r=t.current.value;try{if(s({type:"START_LOADING"}),!await I())return l("Server is down."),s({type:"STOP_LOADING"});const e=await fetch("".concat(D,"/auth/login"),{method:"POST",body:JSON.stringify({email:n,password:r}),headers:{"Content-Type":"application/json"}}),t=await e.json();if(!e.ok)throw new Error(t.detail,{cause:t.errors});localStorage.setItem("token",t.token),localStorage.setItem("refreshToken",t.refreshToken);const c=N.a.decode(t.token);s(g(c)),s({type:"STOP_LOADING"})}catch(i){var o;const e=null!==(o=i.cause)&&void 0!==o?o:[];if(e.some((e=>"UserNotFound"===e.code)))l(c.description);else if(e.some((e=>"EmailNotVerified"===e.code))){const e=async()=>{await fetch("".concat(D,"/auth/send-email-verification?email=").concat(encodeURIComponent(n)),{method:"POST"}),l("Email sent")};l(Object(L.jsxs)("div",{children:["Email not verified",Object(L.jsx)("br",{}),Object(L.jsx)("span",{className:"link",onClick:e,children:"click here"})," to send verification email"]}))}else l(i.message);s({type:"STOP_LOADING"})}},children:[Object(L.jsx)("input",{type:"text",placeholder:"Email",id:"email",ref:e,onChange:A}),Object(L.jsx)("input",{type:"password",placeholder:"Password",id:"password",ref:t,onChange:A}),Object(L.jsx)("button",{id:"login",className:"".concat(a?null:"disabled"),children:"Log In"})]}),Object(L.jsx)(o.b,{to:"/accounts/password/reset",children:"Forgot password?"})]}),Object(L.jsx)("div",{className:"extra outlined",children:Object(L.jsxs)("span",{children:["Don't have an account? ",Object(L.jsx)(o.b,{to:"/accounts/email-signup",className:"button",children:"Sign Up"})]})})]})},V=s.p+"static/media/red-x.1684dcf4.png",Y=s(16);var K=()=>{const e=Object(i.b)(),t=Object(Y.useHistory)(),{search:s}=Object(Y.useLocation)(),a=new URLSearchParams(s),n=a.get("mode"),r=a.get("user"),o=a.get("token"),[l,A]=Object(c.useState)(""),[d,j]=Object(c.useState)({}),u=Object(c.useRef)(),h=Object(c.useRef)(),[m,b]=Object(c.useState)(!1),[O,x]=Object(c.useState)(!1);Object(c.useEffect)((()=>document.title="Verification \u2022 Instadicey"),[]);const p=()=>f()&&v()?x(!0):x(!1),f=()=>!(u.current.value.length<6),v=()=>h.current.value===u.current.value,g=async e=>{if(e.preventDefault(),!O)return;const t=u.current.value;try{const e=await fetch("".concat(D,"/auth/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,newPassword:t,token:o})});if(!e.ok){const t=await e.json();throw new Error(t.detail)}b(!0),j({type:"password-reset",ok:!0})}catch(c){var s;A(null!==(s=c.message)&&void 0!==s?s:"An error occurred. Please, try again later."),j({type:"password-reset",ok:!1})}},w=async()=>{switch(n){case"verifyEmail":await(async()=>{try{if(!r||!o)throw new Error("Email or token missing.");var s;if(localStorage.token){if(401===(s=await fetch("".concat(D,"/auth/confirm-email-change?newEmail=").concat(encodeURIComponent(r),"&code=").concat(encodeURIComponent(o)),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}})).status)return R(e,t);await B(e,t)}else s=await fetch("".concat(D,"/auth/confirm-email?encodedEmail=").concat(encodeURIComponent(r),"&code=").concat(encodeURIComponent(o)),{method:"POST"});if(!s.ok){const e=await s.json();throw new Error(e.detail,{cause:e.errors})}j({type:"email-verification",ok:!0})}catch(c){if(c.message.includes("Failed to fetch"))A("Server is down.");else{const e=c.cause;r&&o?e.length?(e.some((e=>"NotFound"===e.code))||e.some((e=>"InvalidToken"===e.code)))&&A(c.message):A("An error has occurred."):A("Email or token missing.")}j({type:"email-verification",ok:!1})}e({type:"STOP_LOADING"})})();break;case"resetPassword":await(async()=>{try{if(!r||!o)throw new Error("Email or token missing.");if(!(await fetch("".concat(D,"/auth/check-password-reset-token?email=").concat(encodeURIComponent(r),"&token=").concat(encodeURIComponent(o)),{method:"POST"})).ok)throw new Error("Token is invalid or user was not found.")}catch(s){var t;j({type:"password-reset",ok:!1}),A(null!==(t=s.message)&&void 0!==t?t:"Please try to reset the password again.")}e({type:"STOP_LOADING"})})()}};return Object(c.useEffect)((()=>{e({type:"START_LOADING"}),w()}),[n]),"resetPassword"!==n||m||!1===d.ok?d.ok?Object(L.jsxs)("div",{className:"verification-window success outlined",children:[Object(L.jsx)("div",{className:"icon",children:Object(L.jsx)("img",{src:W,alt:"success"})}),"email-verification"===d.type?Object(L.jsxs)("div",{className:"text-div",children:[Object(L.jsx)("h1",{children:"Your email address has been verified"}),Object(L.jsx)("p",{children:"Please go back to the sign up page to continue."})]}):"password-reset"===d.type?Object(L.jsxs)("div",{className:"text-div",children:[Object(L.jsx)("h1",{children:"Your password has been reset"}),Object(L.jsx)("p",{children:"You can now log in with the new password."})]}):null]}):!1===d.ok?Object(L.jsxs)("div",{className:"verification-window failed outlined",children:[Object(L.jsx)("div",{className:"icon",children:Object(L.jsx)("img",{src:V,alt:"failed"})}),"email-verification"===d.type||"password-reset"===d.type?Object(L.jsxs)("div",{className:"text-div",children:[Object(L.jsx)("h1",{children:"An error has occured"}),Object(L.jsx)("p",{children:l})]}):null]}):null:Object(L.jsxs)("div",{className:"verification-window outlined password-reset",children:[Object(L.jsx)("div",{className:"icon",children:Object(L.jsx)("img",{src:P,alt:"logo"})}),Object(L.jsxs)("div",{className:"email-div",children:[Object(L.jsx)("h2",{children:"Your Email:"}),Object(L.jsx)("span",{children:r})]}),Object(L.jsxs)("form",{onSubmit:g,children:[Object(L.jsx)("input",{type:"password",id:"password",placeholder:"Password (at least 6 characters)",ref:u,onChange:p}),Object(L.jsx)("input",{type:"password",id:"confirm password",placeholder:"Confirm Password",ref:h,onChange:p}),Object(L.jsx)("button",{className:"".concat(O?null:"disabled"),children:"Reset Password"})]})]})};var q=()=>{const e=Object(i.b)(),t=Object(Y.useHistory)(),s=Object(i.c)((e=>e.currentUser)),[a,n]=Object(c.useState)(null),[r,l]=Object(c.useState)(null),A=Object(c.useRef)(),d=Object(c.useRef)(),j=Object(c.useRef)(),u=()=>A.current.value.length>0&&d.current.value.length>0&&j.current.value.length>0?n(!0):n(!1);return s?Object(L.jsxs)("div",{className:"account-element change-password",children:[Object(L.jsxs)("div",{className:"element profile-pic-container",children:[Object(L.jsx)("div",{className:"img-container outlined left",children:Object(L.jsx)("img",{src:s.profilePic,alt:"".concat(s.username,"'s profile pic'")})}),Object(L.jsx)("div",{className:"right",children:s.username})]}),Object(L.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),a){try{l(!0);const s=A.current.value,c=d.current.value;if(c!==j.current.value)throw new Error("Password don't match");if(c.length<6)throw new Error("Password too short");const a=await fetch("".concat(D,"/auth/change-password"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/json"},body:JSON.stringify({currentPassword:s,newPassword:c})});if(401===a.status)return R(e,t);if(!a.ok){const e=await a.json();throw new Error(e.detail)}e(y("Password updated successfully.","success"))}catch(n){var c;e(y(null!==(c=n.message)&&void 0!==c?c:"Oops, please try again later.","error"))}A.current.value="",d.current.value="",j.current.value="",l(!1)}},children:[Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("div",{className:"left",children:Object(L.jsx)("label",{htmlFor:"old-password",children:"Old Password"})}),Object(L.jsx)("div",{className:"right",children:Object(L.jsx)("input",{type:"password",id:"old-password",className:"outlined",ref:A,onChange:u})})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("div",{className:"left",children:Object(L.jsx)("label",{htmlFor:"new-password",children:"New Password"})}),Object(L.jsx)("div",{className:"right",children:Object(L.jsx)("input",{type:"password",id:"new-password",className:"outlined",ref:d,onChange:u})})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("div",{className:"left",children:Object(L.jsx)("label",{htmlFor:"confirm-password",children:"Confirm New Password"})}),Object(L.jsx)("div",{className:"right",children:Object(L.jsx)("input",{type:"password",id:"confirm-password",className:"outlined",ref:j,onChange:u})})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("div",{className:"left"}),r?Object(L.jsx)("button",{className:"loading",children:Object(L.jsx)("div",{children:Object(L.jsx)("img",{src:T,alt:"loading"})})}):Object(L.jsx)("button",{className:"submit ".concat(a?null:"disabled"),children:"Change Password"})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("div",{className:"left"}),Object(L.jsx)(o.b,{to:"/accounts/password/reset",className:"forgot-password",children:"Forgot Password?"})]})]})]}):Object(L.jsx)(Q,{})};var _=()=>{const e=Object(i.b)(),t=Object(Y.useHistory)(),s=Object(i.c)((e=>e.currentUser)),[a,n]=Object(c.useState)(!1),[r,o]=Object(c.useState)(!1),[l,A]=Object(c.useState)(!1),[d,j]=Object(c.useState)(!1),[u,h]=Object(c.useState)(!1),[m,b]=Object(c.useState)(!1),O=Object(c.useRef)(),x=Object(c.useRef)(),p=Object(c.useRef)(),f=Object(c.useRef)(),v=Object(c.useRef)(),g=Object(c.useRef)(),w=()=>b(!0),N=()=>b(!1),S=()=>a?null:n(!0),k=async()=>await B(e,t);return s?Object(L.jsxs)("div",{className:"account-element edit-profile",children:[m&&Object(L.jsx)("div",{className:"dialog-box-container",onClick:N,children:Object(L.jsxs)("div",{className:"dialog-box",onClick:e=>e.stopPropagation(),children:[Object(L.jsx)("h2",{children:"Change Profile Photo"}),Object(L.jsx)("button",{className:"upload text",onClick:()=>O.current.click(),children:"Upload Photo"}),Object(L.jsx)("button",{className:"remove text",onClick:async()=>{N(),h(!0);try{const s=await fetch("".concat(D,"/user/edit/profile-pic/reset"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===s.status)return R(e,t);if(!s.ok){const e=await s.json();throw new Error(e.detail,{cause:e.errors})}await k()}catch(s){e(y(s.message,"error"))}h(!1)},children:"Remove Current Photo"}),Object(L.jsx)("button",{className:"cancel text",onClick:N,children:"Cancel"})]})}),Object(L.jsxs)("div",{className:"element profile-pic-container",children:[Object(L.jsxs)("div",{className:"img-container outlined left",onClick:w,children:[u&&Object(L.jsx)("div",{className:"loading",children:Object(L.jsx)("img",{src:T,alt:"loading"})}),Object(L.jsx)("img",{src:s.profilePic,alt:"".concat(s.username,"'s profile pic'")}),Object(L.jsx)("input",{id:"photo",type:"file",accept:"image/png, image/jpg, image/jpeg, image/pjpeg, image/jfif, image/pjp",style:{display:"none"},ref:O,onChange:async s=>{try{const c=s.target.files[0];if(!c)throw new Error("No photo uploaded");if(!O.current.accept.split(", ").includes(c.type))throw new Error("Not a supported photo format");N(),h(!0);const a=new FormData;a.append("newProfilePic",c);const n=await fetch("".concat(D,"/user/edit/profile-pic"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)},body:a});if(401===n.status)return R(e,t);if(!n.ok){const e=await n.json();throw new Error(e.detail,{cause:e.errors})}await k(),O.current.value="",h(!1),e(y("Photo updated successfully","success"))}catch(c){if(console.error(c),"No photo uploaded"===c.message)return null;if("Not a supported photo format"===c.message)return e(y("Not a supported photo format.","error"));e(y("Oops, please try again later.","error"))}}})]}),Object(L.jsxs)("div",{className:"right",children:[s.username,Object(L.jsx)("button",{className:"text",onClick:w,children:"Change Profile Photo"})]})]}),Object(L.jsxs)("form",{onSubmit:async c=>{if(c.preventDefault(),a){A(!0);try{let c=x.current.value,a=p.current.value,n=f.current.value;if(s.username!==p.current.value){if(a.length>20)throw new Error("Username too long");if(""===a.trim())throw new Error("Username not entered");if(!a.match(/^[A-Za-z0-9]*$/))throw new Error("Username not English")}if(s.bio!==f.current.value&&n.length>150)throw new Error("Bio too long");const r=await fetch("".concat(D,"/user/edit"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/json"},body:JSON.stringify({username:a,realname:0===c.trim().length?null:c,bio:0===n.trim().length?null:n})});if(401===r.status)return R(e,t);if(!r.ok){const e=await r.json();throw new Error(e.detail,{cause:e.errors})}await k(),e(y("Info updated.","success"))}catch(o){var r;n(!1),e(y(null!==(r=o.message)&&void 0!==r?r:"Oops, please try again later.","error"))}A(!1)}},children:[Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("label",{htmlFor:"name",className:"left",children:"Name"}),Object(L.jsxs)("div",{className:"right",children:[Object(L.jsx)("input",{type:"text",id:"name",defaultValue:s.realName,placeholder:"Name",ref:x,className:"outlined",onChange:S}),Object(L.jsx)("p",{children:"Help people discover your account by using the name you're known by: either your full name, nickname, or business name."})]})]}),"guest"!==s.username&&Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("label",{htmlFor:"username",className:"left",children:"Username"}),Object(L.jsx)("div",{className:"right",children:Object(L.jsx)("input",{type:"text",id:"username",defaultValue:s.username,placeholder:"Username",ref:p,className:"outlined",onChange:S})})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("label",{htmlFor:"bio",className:"left",children:"Bio"}),Object(L.jsx)("div",{className:"right",children:Object(L.jsx)("textarea",{id:"bio",defaultValue:s.bio,ref:f,className:"outlined",onChange:S})})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("div",{className:"left"}),l?Object(L.jsx)("button",{className:"loading",children:Object(L.jsx)("div",{children:Object(L.jsx)("img",{src:T,alt:"loading"})})}):Object(L.jsx)("button",{className:"submit ".concat(a?null:"disabled"),children:"Submit"})]})]}),"guest"!==s.username&&Object(L.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),!r)return;j(!0);const c=v.current.value,a=g.current.value;try{if(""===c.trim())throw new Error("Email can't be empty");if(!c.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/))throw new Error("Email is invalid");if(""===a.trim())throw new Error("Password can't be empty");const s=await fetch("".concat(D,"/auth/send-email-change-verification"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/json"},body:JSON.stringify({email:c,password:a})});if(401===s.status)return R(e,t);if(!s.ok){const e=await s.json();throw new Error(e.detail)}e(y("Email verification sent.","success"))}catch(n){e(y(n.message,"error"))}j(!1)},children:[Object(L.jsxs)("div",{className:"element info",children:[Object(L.jsx)("span",{className:"left"}),Object(L.jsxs)("div",{className:"right",children:[Object(L.jsx)("p",{className:"header",children:"Personal Information"}),Object(L.jsx)("p",{children:"Provide your personal information, even if the account is used for a business, a pet or something else. This won't be a part of your public profile."})]})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("label",{htmlFor:"email",className:"left",children:"Email"}),Object(L.jsxs)("div",{className:"right",children:[Object(L.jsx)("input",{type:"text",id:"email",defaultValue:s.email,placeholder:"Email",ref:v,className:"outlined",onChange:()=>r?null:o(!0)}),v.current&&s.email!==v.current.value?Object(L.jsx)("input",{type:"password",id:"password",placeholder:"Confirm Password",ref:g,className:"outlined"}):null]})]}),Object(L.jsxs)("div",{className:"element",children:[Object(L.jsx)("div",{className:"left"}),d?Object(L.jsx)("button",{className:"loading",children:Object(L.jsx)("div",{children:Object(L.jsx)("img",{src:T,alt:"loading"})})}):Object(L.jsx)("button",{className:"submit ".concat(r?null:"disabled"),children:"Submit"})]})]})]}):Object(L.jsx)(Q,{})};s(391);var $=()=>{const e=Object(x.useHistory)(),t=Object(C.useMediaQuery)({query:"(max-width: 600px)"}),s=Object(i.c)((e=>e.currentUser));return Object(c.useEffect)((()=>{"/accounts/edit"===e.location.pathname?document.title="Edit Profile \u2022 Instadicey":"/accounts/password/change"===e.location.pathname&&(document.title="Change Password \u2022 Instadicey")}),[e.location.pathname]),Object(L.jsxs)("div",{className:"account-edit outlined",children:[!t&&Object(L.jsxs)("ul",{className:"sidebar",children:[Object(L.jsx)("li",{children:Object(L.jsx)(o.c,{exact:!0,to:"/accounts/edit",activeClassName:"selected",children:"Edit Profile"})}),"guest"!==s.username&&Object(L.jsx)("li",{children:Object(L.jsx)(o.c,{to:"/accounts/password/change",activeClassName:"selected",children:"Change Password"})})]}),Object(L.jsx)("div",{className:"main",children:Object(L.jsxs)(x.Switch,{children:[Object(L.jsx)(x.Route,{exact:!0,path:"/accounts/edit",component:_}),"guest"!==s.username&&Object(L.jsx)(x.Route,{exact:!0,path:"/accounts/password/change",component:q})]})})]})},ee=s(424),te=s(418),se=s(426);var ce=e=>{let{target:t}=e;const s=Object(i.b)(),a=Object(Y.useHistory)(),n=Object(i.c)((e=>e.currentUser)),[r,o]=Object(c.useState)(null),[l,A]=Object(c.useState)(!1);Object(c.useEffect)((()=>{if(n){(async()=>{o(!0);const e=await fetch("".concat(D,"/user/following-check/").concat(t.username),{headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(s,a);if(!e.ok)return A(!1);const c=await e.json();A(c),o(!1)})()}}),[n,t]);return r?Object(L.jsx)("button",{className:"follow-btn loading",children:Object(L.jsx)("div",{children:Object(L.jsx)("img",{src:T,alt:"loading"})})}):l?Object(L.jsx)("button",{className:"follow-btn unfollow",onClick:async()=>{o(!0);try{const e=await fetch("".concat(D,"/user/unfollow/").concat(t.username),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(s,a);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}A(!1)}catch(c){var e;const t=null!==(e=c.cause)&&void 0!==e?e:[];t.some((e=>"NotFound"===e.code))?s(y("User not found.","error")):t.some((e=>"Duplicate"===e.code))?s(y("User already not followed","error")):s(y(c.message,"error"))}o(!1)},children:"Unfollow"}):Object(L.jsx)("button",{className:"follow-btn follow",onClick:async()=>{o(!0);try{const e=await fetch("".concat(D,"/user/follow/").concat(t.username),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(s,a);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}A(!0)}catch(c){var e;const t=null!==(e=c.cause)&&void 0!==e?e:[];t.some((e=>"NotFound"===e.code))?s(y("User not found.","error")):t.some((e=>"Duplicate"===e.code))?s(y("User already followed","error")):s(y(c.message,"error"))}o(!1)},children:"Follow"})};var ae=e=>{let{size:t=24,user:s,marginLeft:c=10,marginRight:a=0}=e;return s.isVerified?Object(L.jsx)("span",{className:"verified",style:{marginLeft:c,marginRight:a},children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-1.959 17l-4.5-4.319 1.395-1.435 3.08 2.937 7.021-7.183 1.422 1.409-8.418 8.591z"})})}):null};var ne=e=>{const{title:t,users:s,closeFollowListWindow:a,newMessage:n}=e,r=Object(i.b)(),l=Object(Y.useHistory)(),A=Object(i.c)((e=>e.currentUser)),[d,j]=Object(c.useState)(!1);return Object(L.jsx)("div",{className:"backdrop container",onClick:a,children:Object(L.jsxs)("div",{className:"follow-list-window",onClick:e=>e.stopPropagation(),children:[Object(L.jsxs)("div",{className:"header",children:[Object(L.jsx)("h1",{children:t}),Object(L.jsx)("span",{className:"close",onClick:a,children:"X"})]}),d?Object(L.jsx)("ul",{className:"loading",children:[0,1,2,3,4,5,6,7,8].map((e=>Object(L.jsx)("li",{className:"person",children:Object(L.jsxs)("div",{className:"profile",children:[Object(L.jsx)("div",{className:"profile-pic"}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsx)("span",{className:"real-name"}),Object(L.jsx)("span",{className:"username"})]})]})},e)))}):Object(L.jsx)("ul",{children:n?s.map((e=>Object(L.jsx)(o.b,{to:"",className:"person",onClick:()=>(async e=>{a(),r({type:"START_LOADING"});try{const t=await fetch("".concat(D,"/chat/room"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token),"Content-Type":"application/json"},body:JSON.stringify([e])});if(401===t.status)return R(r,l);const s=await t.json();if(!t.ok)throw new Error(s.detail);l.push("/direct/t/".concat(s.id))}catch(t){r(y(t.message,"error"))}r({type:"STOP_LOADING"})})(e.username),children:Object(L.jsxs)("div",{className:"profile",children:[Object(L.jsx)("div",{className:"profile-pic",children:Object(L.jsx)("img",{src:e.profilePic,alt:"".concat(e.username,"'s Pic")})}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsx)("div",{style:{display:"flex"},children:Object(L.jsx)("span",{className:"username",children:e.username})}),Object(L.jsx)("span",{className:"real-name",children:e.realName})]})]})},e.username))):s.map((e=>Object(L.jsxs)("li",{className:"person",children:[Object(L.jsxs)("div",{className:"profile",children:[Object(L.jsx)(o.b,{to:"/".concat(e.username),children:Object(L.jsx)("div",{className:"profile-pic",children:Object(L.jsx)("img",{src:e.profilePic,alt:"".concat(e.username,"'s Pic")})})}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsxs)("div",{style:{display:"flex"},children:[Object(L.jsx)(o.b,{to:"/".concat(e.username),className:"username",children:e.username})," ",Object(L.jsx)(ae,{user:e,size:15,marginLeft:7.5})]}),Object(L.jsx)("span",{className:"real-name",children:e.realName})]})]}),A&&A.username===e.username?null:Object(L.jsx)(ce,{target:e,startLoading:()=>j(!0),stopLoading:()=>j(!1)})]},e.username)))})]})})};var re=e=>{let{size:t=25,target:s,isComment:a}=e;const n=Object(i.b)(),r=Object(Y.useHistory)(),o=Object(i.c)((e=>e.currentUser)),[l,A]=Object(c.useState)(!1);Object(c.useEffect)((()=>{(async()=>{o&&s.likes.some((e=>e.username===o.username))&&A(!0)})()}),[o,s]);return l?Object(L.jsx)("button",{className:"like liked icon",onClick:async()=>{if(!o)return alert("sign in");try{var e;if(401===(e=a?await fetch("".concat(D,"/like/comment/remove/").concat(s.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}}):await fetch("".concat(D,"/like/post/remove/").concat(s.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}})).status)return R(n,r);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}A(!1)}catch(c){var t;n(y(null!==(t=c.message)&&void 0!==t?t:"Oops, try again later.","error"))}},children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z"})})}):Object(L.jsx)("button",{className:"like icon",onClick:async()=>{if(!o)return alert("sign in");try{var e;if(401===(e=a?await fetch("".concat(D,"/like/comment/").concat(s.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}}):await fetch("".concat(D,"/like/post/").concat(s.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}})).status)return R(n,r);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}A(!0)}catch(c){var t;n(y(null!==(t=c.message)&&void 0!==t?t:"Oops, try again later.","error"))}},children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M12 21.593c-5.63-5.539-11-10.297-11-14.402 0-3.791 3.068-5.191 5.281-5.191 1.312 0 4.151.501 5.719 4.457 1.59-3.968 4.464-4.447 5.726-4.447 2.54 0 5.274 1.621 5.274 5.181 0 4.069-5.136 8.625-11 14.402m5.726-20.583c-2.203 0-4.446 1.042-5.726 3.238-1.285-2.206-3.522-3.248-5.719-3.248-3.183 0-6.281 2.187-6.281 6.191 0 4.661 5.571 9.429 12 15.809 6.43-6.38 12-11.148 12-15.809 0-4.011-3.095-6.181-6.274-6.181"})})})};var oe=e=>{let{commentData:t,postData:s,noPhoto:a,noTimestamp:n,noLike:r,noLikesCounter:l,noRemove:A,setLikesWindow:d,refreshComments:j}=e;const u=Object(i.b)(),h=Object(Y.useHistory)(),m=Object(i.c)((e=>e.currentUser)),b=new Date(t.createdAt),[O,x]=Object(c.useState)(!1);return Object(L.jsxs)("div",{className:"comment ".concat(O?"disabled":null),style:r?null:{paddingRight:"25px"},children:[a||Object(L.jsx)(o.b,{to:"/".concat(t.user.username),children:Object(L.jsx)("div",{className:"profile-pic",children:Object(L.jsx)("img",{src:t.user.profilePic,alt:"".concat(t.user.username,"'s profile pic")})})}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsxs)("div",{style:{display:"inline-block"},children:[Object(L.jsx)(o.b,{to:"/".concat(t.user.username),className:"username",children:t.user.username}),Object(L.jsx)(ae,{size:12.5,user:t.user,marginLeft:0,marginRight:7.5}),Object(L.jsx)("span",{className:"text",children:t.comment})]}),Object(L.jsxs)("div",{children:[n||Object(L.jsx)("span",{className:"timestamp",title:Object(ee.a)(b,"d MMM, yyyy"),children:Object(se.a)(b)}),l||0===t.likes.length||Object(L.jsxs)("span",{className:"likes",onClick:()=>d(t.likes),children:[t.likes.length," likes"]}),m&&(m.username===t.user.username||m.username===s.user.username)&&!A&&Object(L.jsx)("button",{className:"icon",style:{width:15,height:15},onClick:async()=>{try{x(!0);const e=await fetch("".concat(D,"/comment/delete/").concat(t.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(u,h);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}await j()}catch(e){u(y(e.message,"error"))}x(!1)},children:Object(L.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M9 3h6v-1.75c0-.066-.026-.13-.073-.177-.047-.047-.111-.073-.177-.073h-5.5c-.066 0-.13.026-.177.073-.047.047-.073.111-.073.177v1.75zm11 1h-16v18c0 .552.448 1 1 1h14c.552 0 1-.448 1-1v-18zm-10 3.5c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm5 0c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm8-4.5v1h-2v18c0 1.105-.895 2-2 2h-14c-1.105 0-2-.895-2-2v-18h-2v-1h7v-2c0-.552.448-1 1-1h6c.552 0 1 .448 1 1v2h7z"})})})]})]}),r||Object(L.jsx)(re,{size:15,target:t,isComment:!0})]})};var ie=e=>{let{size:t=25,target:s}=e;const a=Object(i.b)(),n=Object(Y.useHistory)(),r=Object(i.c)((e=>e.currentUser)),[o,l]=Object(c.useState)(!1);Object(c.useEffect)((()=>{(async()=>{if(!r)return;const e=await fetch("".concat(D,"/user/saved-posts"),{headers:{Authorization:"Bearer ".concat(localStorage.token)}}),t=await e.json();e.ok&&t.some((e=>e.id===s.id))&&l(!0)})()}),[r,s]);return o?Object(L.jsx)("button",{className:"save saved icon",onClick:async()=>{try{const e=await fetch("".concat(D,"/user/saved-posts/remove/").concat(s.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(a,n);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}l(!1)}catch(t){var e;a(y(null!==(e=t.message)&&void 0!==e?e:"Oops, try again later.","error"))}},children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M18 24l-6-5.269-6 5.269v-24h12v24z"})})}):Object(L.jsx)("button",{className:"save icon",onClick:async()=>{try{const e=await fetch("".concat(D,"/user/saved-posts/").concat(s.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(a,n);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}l(!0)}catch(t){var e;a(y(null!==(e=t.message)&&void 0!==e?e:"Oops, try again later.","error"))}},children:Object(L.jsx)("svg",{width:t,height:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M5 0v24l7-6 7 6v-24h-14zm1 1h12v20.827l-6-5.144-6 5.144v-20.827z"})})})};var le=e=>{var t;let{post:s,isVertical:a,refreshPost:n}=e;const r=Object(x.useHistory)(),l=Object(x.useLocation)(),A=Object(c.useRef)(),d=Object(i.b)(),j=Object(i.c)((e=>e.currentUser)),u=new Date(s.createdAt),[h,m]=Object(c.useState)(!1),[b,O]=Object(c.useState)(!1),[p,f]=Object(c.useState)(!1),[v,g]=Object(c.useState)(!1),w=()=>g(!1),[N,S]=Object(c.useState)(null),[k,C]=Object(c.useState)(!1);Object(c.useEffect)((()=>()=>w()),[]);const E=async e=>{if(e.preventDefault(),b)try{f(!0);const e=A.current.value;if(e.trim().length<1)return d(y("Please enter a comment.","error"));if(e.length>2200)return d(y("Comment too long. max is 2200 characters.","error"));const t=await fetch("".concat(D,"/comment/post/").concat(s.id),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.token)},body:JSON.stringify({comment:e})});if(401===t.status)return R(d,r);if(!t.ok){const e=await t.json();throw new Error(e.detail,{cause:e.errors})}await n(),f(!1),A.current.value=""}catch(c){var t;d(y(null!==(t=c.message)&&void 0!==t?t:"Oops, try again later.","error"))}},z=e=>{13===e.keyCode&&!1===e.shiftKey&&(e.preventDefault(),E(e))},P=async()=>{try{if(j.username!==s.user.username)throw new Error("Fuck off");C(!0);const e=await fetch("".concat(D,"/post/delete/").concat(s.id),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(d,r);if(!e.ok){const t=await e.json();throw new Error(t.detail,{cause:t.errors})}r.push("/")}catch(e){d(y(e.message,"error"))}C(!1)};return j&&s?a?Object(L.jsxs)("div",{className:"post-window outlined vertical",children:[N?Object(L.jsx)(ne,{title:"Likes",users:N,closeFollowListWindow:()=>S(null)}):null,v&&Object(L.jsx)("div",{className:"dialog-box-container",onClick:w,children:Object(L.jsxs)("div",{className:"dialog-box",onClick:e=>e.stopPropagation(),children:["/"!==l.pathname?null:Object(L.jsx)("button",{className:"text",onClick:()=>r.push("/p/".concat(s.id)),children:"Go to post"}),"/"!==l.pathname?null:Object(L.jsx)("button",{className:"text",onClick:()=>{navigator.clipboard.writeText("".concat(window.location.origin,"/#/p/").concat(s.id)),w()},children:"Copy Link"}),j.username===s.user.username&&Object(L.jsx)("button",{className:"remove text",onClick:P,children:"Delete"}),Object(L.jsx)("button",{className:"cancel text",onClick:w,children:"Cancel"})]})}),Object(L.jsxs)("div",{className:"poster",children:[Object(L.jsx)(o.b,{to:"/".concat(s.user.username),children:Object(L.jsx)("div",{className:"profile-pic outlined round",children:Object(L.jsx)("img",{src:s.user.profilePic,alt:"Profile Pic"})})}),Object(L.jsx)(o.b,{to:"/".concat(s.user.username),className:"username",children:s.user.username}),Object(L.jsx)("button",{className:"icon",style:{width:15,height:15},onClick:()=>g(!0),children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M6 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z"})})})]}),Object(L.jsx)("div",{className:"post-photo",children:Object(L.jsx)("div",{className:"container",children:Object(L.jsx)("img",{src:s.photo,alt:s.caption})})}),Object(L.jsxs)("div",{className:"side",children:[Object(L.jsxs)("div",{className:"info",children:[Object(L.jsxs)("div",{className:"interactions",children:[Object(L.jsxs)("div",{style:{display:"flex"},children:[Object(L.jsx)(re,{target:s}),Object(L.jsx)("button",{className:"comment-bubble icon",children:Object(L.jsx)("svg",{width:"25",height:"25",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M12 1c-6.338 0-12 4.226-12 10.007 0 2.05.739 4.063 2.047 5.625l-1.993 6.368 6.946-3c1.705.439 3.334.641 4.864.641 7.174 0 12.136-4.439 12.136-9.634 0-5.812-5.701-10.007-12-10.007m0 1c6.065 0 11 4.041 11 9.007 0 4.922-4.787 8.634-11.136 8.634-1.881 0-3.401-.299-4.946-.695l-5.258 2.271 1.505-4.808c-1.308-1.564-2.165-3.128-2.165-5.402 0-4.966 4.935-9.007 11-9.007"})})})]}),Object(L.jsx)(ie,{target:s})]}),Object(L.jsxs)("span",{className:"likes",onClick:()=>S(s.likes),children:[Object(L.jsx)("span",{className:"number",children:s.likes.length})," likes"]})]}),Object(L.jsxs)("div",{className:"comments",children:[0===(null===(t=s.caption)||void 0===t?void 0:t.length)||Object(L.jsx)(oe,{commentData:{user:s.user,comment:s.caption,timestamp:s.timestamp},noLike:!0,noPhoto:!0,noTimestamp:!0,noLikesCounter:!0,noRemove:!0,postData:s}),s.comments.length>2&&!h&&Object(L.jsxs)(o.b,{onClick:()=>m(!0),to:"/p/".concat(s.id),style:{color:"#8e8e8e",fontSize:"0.9em",fontWeight:"500"},children:["View all ",s.comments.length," comments"]}),s.comments.slice(0,h?s.comments.length:2).map((e=>Object(L.jsx)(oe,{postData:s,commentData:e,setLikesWindow:S,refreshComments:n,noPhoto:!0,noTimestamp:!0,noLikesCounter:!0},e.id))),Object(L.jsx)("span",{className:"timestamp",title:Object(ee.a)(u,"d MMM, yyyy"),children:(new Date-u)/864e5>7?Object(te.a)(u)===Object(te.a)(new Date)?Object(ee.a)(u,"d MMMM"):Object(ee.a)(u,"d MMMM, yyyy"):Object(se.a)(u)})]}),Object(L.jsxs)("form",{className:"add-comment-container",onSubmit:E,children:[Object(L.jsx)("textarea",{className:p?"add-comment disabled":"add-comment",placeholder:"Add a comment...",ref:A,onChange:()=>A.current.value.length>0?O(!0):O(!1),onKeyDown:z}),Object(L.jsx)("button",{className:"".concat(b?"text":"text disabled"),children:"Post"})]})]})]}):Object(L.jsxs)("div",{className:"post-window outlined ".concat(k?"disabled":""),children:[N?Object(L.jsx)(ne,{title:"Likes",users:N,closeFollowListWindow:()=>S(null)}):null,v&&Object(L.jsx)("div",{className:"dialog-box-container",onClick:w,children:Object(L.jsxs)("div",{className:"dialog-box",onClick:e=>e.stopPropagation(),children:[j&&j.username===s.user.username&&Object(L.jsx)("button",{className:"remove text",onClick:P,children:"Delete"}),Object(L.jsx)("button",{className:"cancel text",onClick:w,children:"Cancel"})]})}),Object(L.jsx)("img",{src:s.photo,alt:s.caption}),Object(L.jsxs)("div",{className:"side",children:[Object(L.jsxs)("div",{className:"poster",children:[Object(L.jsx)(o.b,{to:"/".concat(s.user.username),children:Object(L.jsx)("div",{className:"profile-pic outlined round",children:Object(L.jsx)("img",{src:s.user.profilePic,alt:"Profile Pic"})})}),Object(L.jsx)(o.b,{to:"/".concat(s.user.username),className:"username",children:s.user.username}),Object(L.jsx)(ae,{size:15,user:s.user,marginLeft:7.5}),j&&j.username===s.user.username&&Object(L.jsx)("button",{className:"icon",style:{width:15,height:15},onClick:()=>g(!0),children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M6 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z"})})}),j&&j.username===s.user.username?null:Object(L.jsx)(ce,{target:s.user})]}),Object(L.jsxs)("div",{className:"comments",children:[Object(L.jsx)(oe,{commentData:{user:s.user,comment:s.caption,createdAt:s.createdAt},noLike:!0,noLikesCounter:!0,noRemove:!0,postData:s}),s.comments.map((e=>Object(L.jsx)(oe,{commentData:e,setLikesWindow:S,postData:s,refreshComments:n},e.id)))]}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsxs)("div",{className:"interactions",children:[Object(L.jsxs)("div",{style:{display:"flex"},children:[Object(L.jsx)(re,{target:s}),Object(L.jsx)("button",{className:"comment-bubble icon",children:Object(L.jsx)("svg",{width:"25",height:"25",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M12 1c-6.338 0-12 4.226-12 10.007 0 2.05.739 4.063 2.047 5.625l-1.993 6.368 6.946-3c1.705.439 3.334.641 4.864.641 7.174 0 12.136-4.439 12.136-9.634 0-5.812-5.701-10.007-12-10.007m0 1c6.065 0 11 4.041 11 9.007 0 4.922-4.787 8.634-11.136 8.634-1.881 0-3.401-.299-4.946-.695l-5.258 2.271 1.505-4.808c-1.308-1.564-2.165-3.128-2.165-5.402 0-4.966 4.935-9.007 11-9.007"})})})]}),Object(L.jsx)(ie,{target:s})]}),Object(L.jsxs)("span",{className:"likes",onClick:()=>S(s.likes),children:[Object(L.jsx)("span",{className:"number",children:s.likes.length})," likes"]}),Object(L.jsx)("span",{className:"timestamp",title:Object(ee.a)(u,"d MMM, yyyy"),children:Object(te.a)(u)===Object(te.a)(new Date)?Object(ee.a)(u,"d MMMM"):Object(ee.a)(u,"d MMMM, yyyy")})]}),Object(L.jsxs)("form",{className:"add-comment-container",onSubmit:E,children:[Object(L.jsx)("textarea",{className:p?"add-comment disabled":"add-comment",placeholder:"Add a comment...",ref:A,onChange:()=>A.current.value.length>0?O(!0):O(!1),onKeyDown:z}),Object(L.jsx)("button",{className:"".concat(b?"text":"text disabled"),children:"Post"})]})]})]}):null};var Ae=()=>{const e=Object(c.useRef)(),t=Object(i.b)(),s=Object(Y.useHistory)(),[a,n]=Object(c.useState)(null),[r,o]=Object(c.useState)(null);return Object(c.useEffect)((()=>document.title="Instadicey"),[]),Object(c.useEffect)((()=>{(async()=>{if(localStorage.token){t({type:"START_LOADING"});try{const e=await fetch("".concat(D,"/user/feed"),{headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(t,s);const c=await e.json();if(!e.ok)throw new Error(c.detail);const a=new Date;a.setUTCDate(a.getUTCDate()-3),o(c.filter((e=>new Date(e.createdAt+"Z")>=a))),n(c.filter((e=>new Date(e.createdAt+"Z")<a)))}catch(e){}t({type:"STOP_LOADING"})}})()}),[t,s]),r?Object(L.jsxs)("div",{className:"home-page",children:[r&&Object(L.jsx)("div",{className:"posts",ref:e,children:r.map((e=>Object(L.jsx)(le,{post:e,isVertical:!0},e.id)))}),a&&Object(L.jsxs)("div",{className:"older-posts posts",ref:e,children:[Object(L.jsx)("h2",{children:"Showing posts older than 3 days"}),a.map((e=>Object(L.jsx)(le,{post:e,isVertical:!0},e.id)))]})]}):null};var de=()=>(Object(c.useEffect)((()=>document.title="Page Not Found \u2022 Instadicey"),[]),Object(L.jsxs)("div",{id:"broken-page",children:[Object(L.jsx)("h1",{children:"Sorry, this page isn't available."}),Object(L.jsx)("h2",{children:"The link you followed may be broken, or the page may have been removed."})]}));var je=e=>{let{post:t}=e;const[s,a]=Object(c.useState)(!1);return t?Object(L.jsx)("div",{className:"post-card",onMouseOver:()=>a(!0),onMouseLeave:()=>a(!1),children:Object(L.jsx)("div",{className:"container",children:Object(L.jsxs)(o.b,{to:"/p/".concat(t.id),children:[s&&Object(L.jsxs)("div",{className:"hovered",children:[Object(L.jsxs)("span",{children:[Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z"})})," ",t.likesCount]}),Object(L.jsxs)("span",{children:[Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"comment-bubble",width:"20",height:"20",viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M.054 23c.971-1.912 2.048-4.538 1.993-6.368-1.308-1.562-2.047-3.575-2.047-5.625 0-5.781 5.662-10.007 12-10.007 6.299 0 12 4.195 12 10.007 0 6.052-6.732 11.705-15.968 9.458-1.678 1.027-5.377 2.065-7.978 2.535z"})})," ",t.commentsCount]})]}),Object(L.jsx)("img",{src:t.photo,alt:t.caption})]})})}):Object(L.jsx)("div",{className:"post-card loading outlined",children:Object(L.jsx)("div",{className:"container",children:Object(L.jsx)("img",{src:T,alt:"loading",style:{height:"25%",position:"absolute",inset:0,margin:"auto"}})})})};s(392);var ue=()=>{const{username:e}=Object(x.useParams)(),t=Object(i.b)(),s=Object(Y.useHistory)(),a=Object(i.c)((e=>e.currentUser)),[n,r]=Object(c.useState)(null),[l,A]=Object(c.useState)(null),[d,j]=Object(c.useState)(!1),[u,h]=Object(c.useState)(!1),m=()=>{j(!1),h(!1)};return Object(c.useEffect)((()=>{m();(async()=>{t({type:"START_LOADING"}),await(async()=>{try{const n=await fetch("".concat(D,"/user/").concat(e)),o=await n.json();if(!n.ok)throw new Error(o.detail,{cause:o.errors});if(r(o),a&&a.username===o.username)try{const e=await fetch("".concat(D,"/user/saved-posts"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(401===e.status)return R(t,s);const c=await e.json();if(!e.ok)throw new Error(c.detail,c.errors);A(c)}catch(c){A(null)}}catch(n){return r(!1)}})(),t({type:"STOP_LOADING"})})()}),[e]),Object(c.useEffect)((()=>{n&&(n.realName?document.title="".concat(n.realName," (@").concat(n.username,") \u2022 Instadicey"):document.title="@".concat(n.username," \u2022 Instadicey"))}),[n]),!1===n?Object(L.jsx)(de,{}):n?Object(L.jsxs)("div",{className:"user-profile",children:[d?Object(L.jsx)(ne,{title:"Following",users:n.following,closeFollowListWindow:m}):u?Object(L.jsx)(ne,{title:"Followers",users:n.followers,closeFollowListWindow:m}):null,Object(L.jsx)("div",{className:"upper",children:Object(L.jsxs)("div",{className:"personal-info",children:[Object(L.jsx)("div",{className:"profile-pic",children:Object(L.jsx)("img",{src:n.profilePic,alt:"".concat(e,"'s profile pic")})}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsxs)("div",{className:"name",children:[n.username,Object(L.jsx)(ae,{user:n}),a&&n.username===a.username?Object(L.jsx)(o.b,{to:"/accounts/edit",className:"edit-profile-btn outlined",children:"Edit Profile"}):Object(L.jsx)(ce,{target:n})]}),Object(L.jsxs)("div",{className:"follow",children:[Object(L.jsxs)("span",{className:"posts",children:[Object(L.jsx)("span",{className:"number",children:n.posts.length})," posts"]}),Object(L.jsxs)("span",{className:"followers",onClick:()=>h(!0),children:[Object(L.jsx)("span",{className:"number",children:n.followers.length})," followers"]}),Object(L.jsxs)("span",{className:"following",onClick:()=>j(!0),children:[Object(L.jsx)("span",{className:"number",children:n.following.length})," following"]})]}),Object(L.jsxs)("div",{className:"bio",children:[Object(L.jsx)("span",{className:"real-name",children:n.realName}),Object(L.jsx)("div",{className:"bio-text",children:n.bio})]})]})]})}),Object(L.jsx)("nav",{children:Object(L.jsxs)("ul",{children:[Object(L.jsx)("li",{children:Object(L.jsxs)(o.c,{exact:!0,to:"/".concat(n.username),activeClassName:"selected",children:[Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon",viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M6 6h-6v-6h6v6zm9-6h-6v6h6v-6zm9 0h-6v6h6v-6zm-18 9h-6v6h6v-6zm9 0h-6v6h6v-6zm9 0h-6v6h6v-6zm-18 9h-6v6h6v-6zm9 0h-6v6h6v-6zm9 0h-6v6h6v-6z"})})," POSTS"]})}),a&&a.username===n.username&&Object(L.jsx)("li",{children:Object(L.jsxs)(o.c,{exact:!0,to:"/".concat(n.username,"/saved"),activeClassName:"selected",children:[Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon",viewBox:"0 0 24 24",children:Object(L.jsx)("path",{d:"M16 2v17.582l-4-3.512-4 3.512v-17.582h8zm2-2h-12v24l6-5.269 6 5.269v-24z"})})," SAVED"]})})]})}),Object(L.jsxs)(x.Switch,{children:[Object(L.jsx)(x.Route,{exact:!0,path:"/:username",children:Object(L.jsx)("div",{className:"post-cards-container",children:n.posts.map((e=>Object(L.jsx)(je,{post:e},e.id)))})}),Object(L.jsx)(x.Route,{exact:!0,path:"/:username/saved",children:Object(L.jsx)("div",{className:"post-cards-container",children:l&&l.map((e=>Object(L.jsx)(je,{post:e},e.id)))})})]})]}):null},he=s(217);const me=(()=>{const e=e=>new Promise(((t,s)=>{const c=new Image;c.addEventListener("load",(()=>t(c))),c.addEventListener("error",(e=>s(e))),c.setAttribute("crossOrigin","anonymous"),c.src=e}));function t(e){return e*Math.PI/180}return{getCroppedImg:async function(s,c){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=await e(s),r=document.createElement("canvas"),o=r.getContext("2d"),i=Math.max(n.width,n.height),l=i/2*Math.sqrt(2)*2;r.width=l,r.height=l,o.translate(l/2,l/2),o.rotate(t(a)),o.translate(-l/2,-l/2),o.drawImage(n,l/2-.5*n.width,l/2-.5*n.height);const A=o.getImageData(0,0,l,l);return r.width=c.width,r.height=c.height,o.putImageData(A,Math.round(0-l/2+.5*n.width-c.x),Math.round(0-l/2+.5*n.height-c.y)),new Promise((e=>r.toBlob((t=>e(t)),"image/png")))}}})();var be=()=>{const e=Object(i.c)((e=>e.currentUser)),t=Object(i.c)((e=>e.newPost)),[s,a]=Object(c.useState)(""),[n,r]=Object(c.useState)({x:0,y:0}),[o,l]=Object(c.useState)(1),[A,d]=Object(c.useState)(0),[j,u]=Object(c.useState)(null);Object(c.useEffect)((()=>m(e?{type:"STOP_LOADING"}:{type:"START_LOADING"})),[s,e]),Object(c.useEffect)((()=>{if(!t)return;const e=new FileReader;e.readAsDataURL(t),e.onloadend=()=>a(e.result)}),[t]);const h=Object(c.useRef)(),m=Object(i.b)(),b=Object(x.useHistory)();Object(c.useEffect)((()=>O.getState().newPost?()=>m(E(null)):b.push("/")),[]);const{getCroppedImg:p}=me;return e&&s?Object(L.jsxs)("div",{className:"new-post",children:[Object(L.jsxs)("div",{className:"header",children:[Object(L.jsx)("button",{className:"cancel text",onClick:()=>b.push("/"),children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"bi bi-x-lg",viewBox:"0 0 16 16",children:Object(L.jsx)("path",{d:"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"})})}),"New Photo Post",Object(L.jsx)("button",{className:"text",onClick:async()=>{try{m({type:"START_LOADING"});const e=h.current.value,c=await p(s,j,A),a=new FormData;a.append("caption",e),a.append("photo",c,t.name);const n=await fetch("".concat(D,"/post/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.token)},body:a}),r=await n.json();if(401===n.status)return R(m,b);if(!n.ok)throw new Error(r.detail,{cause:r.errors});m(y("Post uploaded.","success")),b.push("/p/".concat(r.id))}catch(c){var e;m(y(null!==(e=c.message)&&void 0!==e?e:"Oops, try again later.","error"))}m({type:"STOP_LOADING"})},children:"Share"})]}),Object(L.jsx)("div",{className:"cropper-container",children:Object(L.jsx)(he.a,{image:s,crop:n,zoom:o,zoomSpeed:.5,onCropChange:r,onZoomChange:l,onRotationChange:d,onCropComplete:(e,t)=>u(t),aspect:1})}),Object(L.jsxs)("div",{className:"caption-container outlined",children:[Object(L.jsx)("div",{className:"profile-pic outlined round",children:Object(L.jsx)("img",{src:e.profilePic,alt:"profile pic"})}),Object(L.jsx)("textarea",{className:"caption",placeholder:"Write a caption...",ref:h})]})]}):null};s(397);var Oe=()=>{const{postID:e}=Object(x.useParams)(),t=Object(i.b)(),[s,a]=Object(c.useState)(null),[n,r]=Object(c.useState)(null),[o,l]=Object(c.useState)(!1),A=()=>window.innerWidth<1024?l(!0):l(!1);Object(c.useEffect)((()=>(A(),window.addEventListener("resize",A),()=>window.removeEventListener("resize",A))),[]),Object(c.useEffect)((()=>document.title="Instadicey"),[]);const d=async()=>{try{const t=await fetch("".concat(D,"/post/").concat(e)),s=await t.json();if(!t.ok)throw new Error(s.detail,{cause:s.errors});a(s),await j()}catch(t){console.error(t)}},j=async()=>{try{const t=await fetch("".concat(D,"/post/").concat(e,"/more")),s=await t.json();if(!t.ok)throw new Error(s.detail,{cause:s.errors});r(s)}catch(t){}};return Object(c.useEffect)((()=>{(async()=>{t({type:"START_LOADING"}),await d(),t({type:"STOP_LOADING"})})()}),[e]),s?Object(L.jsxs)("div",{className:"post-page",children:[o?Object(L.jsx)(le,{post:s,refreshPost:d,isVertical:!0}):Object(L.jsx)(le,{post:s,refreshPost:d}),Object(L.jsxs)("div",{className:"more-posts",children:[Object(L.jsx)("header",{children:"More posts from this user"}),n&&Object(L.jsx)("div",{className:"post-cards-container",children:n.map((e=>Object(L.jsx)(je,{post:e},e.id)))})]})]}):Object(L.jsx)(de,{})};var xe=e=>{let{messageInfo:t,noPhoto:s,isSent:c}=e;return Object(L.jsxs)("div",{className:"message ".concat(c?"sent":""),children:[s?Object(L.jsx)("span",{className:"dummy",style:{width:32,height:32}}):Object(L.jsx)(o.b,{to:"/".concat(t.user.username),className:"profile-pic",children:Object(L.jsx)("img",{src:t.user.profilePic,alt:"".concat(t.user.username,"'s profile pic")})}),Object(L.jsx)("span",{className:"text outlined round",children:t.message})]})};var pe=e=>{let{roomID:t}=e;const s=Object(i.b)(),a=Object(x.useHistory)(),n=Object(i.c)((e=>e.currentUser)),r=Object(c.useRef)(),[l,A]=Object(c.useState)(null),[d,j]=Object(c.useState)(null),[u,h]=Object(c.useState)(!1),[m,b]=Object(c.useState)(null);return Object(c.useEffect)((()=>document.title="Instadicey \u2022 Chats")),Object(c.useEffect)((()=>{const e=(new G.a).withUrl("".concat(D,"/chat-hub?roomID=").concat(t),{accessTokenFactory:()=>localStorage.token}).withAutomaticReconnect().build();return e.start().then((()=>{b(e),e.on("ReceiveMessage",(e=>j((t=>[...t,e]))))})).catch((e=>{if(401===e.statusCode)return R(s,a)})),()=>e.stop()}),[t,s,a]),Object(c.useEffect)((()=>{(async()=>{await(async()=>{try{const e=await fetch("".concat(D,"/chat/room?roomID=").concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(s,a);const c=await e.json();if(!e.ok)throw new Error(c.detail);A(c)}catch(e){s(y(e.message,"error"))}})(),await(async()=>{try{const e=await fetch("".concat(D,"/chat/messages?roomID=").concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(s,a);const c=await e.json();if(!e.ok)throw new Error(c.detail);j(c)}catch(e){s(y(e.message,"error"))}})()})()}),[t]),d&&m?Object(L.jsxs)("div",{className:"chat-room",children:[Object(L.jsx)("header",{children:Object(L.jsxs)(o.b,{to:"/".concat(l.users[0].username),style:{display:"flex",alignItems:"center"},children:[Object(L.jsx)("span",{className:"profile-pic",style:{marginRight:"1rem"},children:Object(L.jsx)("img",{src:l.users[0].profilePic,alt:"".concat(l.users[0].username,"'s pic")})}),l.users[0].username]})}),Object(L.jsx)("div",{className:"messages",children:Object(L.jsx)("div",{className:"container",children:d.map(((e,t,s)=>e.user.username===n.username?Object(L.jsx)(xe,{messageInfo:e,noPhoto:!0,isSent:!0},e.id):s[t+1]&&s[t].user.username===s[t+1].user.username?Object(L.jsx)(xe,{messageInfo:e,noPhoto:!0},e.id):Object(L.jsx)(xe,{messageInfo:e},e.id)))})}),Object(L.jsx)("div",{className:"send-message-container",children:Object(L.jsxs)("form",{className:"outlined round",onSubmit:async e=>{e.preventDefault();try{h(!0);const e=r.current.value;if(""===e.trim())throw new Error("Message is empty");await m.invoke("SendMessage",e),r.current.value=""}catch(t){console.error(t)}h(!1)},children:[Object(L.jsx)("input",{className:"".concat(u?"disabled":""),placeholder:"Message...",ref:r}),Object(L.jsx)("button",{className:"text",children:"Send"})]})})]}):null},fe=s.p+"static/media/send-message.3a6be95e.png";s(398);var ve=()=>{const{roomID:e}=Object(x.useParams)(),t=Object(i.c)((e=>e.currentUser)),s=Object(i.b)(),a=Object(Y.useHistory)(),[n,r]=Object(c.useState)(null),[l,A]=Object(c.useState)(null),[d,j]=Object(c.useState)(!1),u=()=>j(!1),h=Object(C.useMediaQuery)({query:"(max-width: 600px)"});Object(c.useEffect)((()=>document.title="Inbox \u2022 Chats"));const m=e=>{let t=e.split(" ");t[1]=t[1].slice(0,1);return t.join(" ")};return Object(c.useEffect)((()=>{if(!t)return;(async()=>{s({type:"START_LOADING"}),await(async()=>{if(t)try{const e=await fetch("".concat(D,"/user/").concat(t.username)),s=await e.json();if(!e.ok)throw new Error(s.detail,{cause:s.errors});const c=[...s.following,...s.followers];r([...new Map(c.map((e=>[e.username,e]))).values()])}catch(e){s(y(e.message))}})(),await(async()=>{if(t)try{const e=await fetch("".concat(D,"/chat/rooms"),{headers:{Authorization:"Bearer ".concat(localStorage.token)}});if(401===e.status)return R(s,a);const t=await e.json();if(!e.ok)throw new Error(t.detail);A(t)}catch(e){console.error(e)}})(),s({type:"STOP_LOADING"})})()}),[t]),Object(c.useEffect)((()=>{if(!t)return;const e=(new G.a).withUrl("".concat(D,"/chat-hub"),{accessTokenFactory:()=>localStorage.token}).withAutomaticReconnect().build();return e.start().then((()=>(e.on("UpdateRoom",(e=>{var s=!1;e.users=e.users.filter((e=>e.username!==t.username)),A((t=>t.map((t=>t.id===e.id?(s=!0,e):t)))),s||A((t=>[...t,e]))})),()=>e.stop()))).catch((e=>{if(401===e.statusCode)return R(s,a)})),()=>e.stop()}),[t,s,a]),t&&l?h?Object(L.jsxs)("div",{className:"inbox-window outlined",children:[d&&Object(L.jsx)(ne,{title:"New Message",users:n,closeFollowListWindow:u,newMessage:!0}),Object(L.jsx)("div",{className:"container",children:Object(L.jsxs)(x.Switch,{children:[Object(L.jsx)(x.Route,{exact:!0,path:"/direct/inbox",children:Object(L.jsxs)("div",{className:"recent-chats left",children:[Object(L.jsxs)("header",{children:[t.username,Object(L.jsx)("button",{className:"icon",onClick:()=>j(!0),children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M8.071 21.586l-7.071 1.414 1.414-7.071 14.929-14.929 5.657 5.657-14.929 14.929zm-.493-.921l-4.243-4.243-1.06 5.303 5.303-1.06zm9.765-18.251l-13.3 13.301 4.242 4.242 13.301-13.3-4.243-4.243z"})})})]}),Object(L.jsx)("ul",{children:l.sort(((e,t)=>new Date(t.lastUpdated)-new Date(e.lastUpdated))).map((e=>{var t;return Object(L.jsx)(o.c,{to:"/direct/t/".concat(e.id),activeClassName:"selected",children:Object(L.jsxs)("li",{children:[Object(L.jsx)("span",{className:"profile-pic",children:Object(L.jsx)("img",{src:e.users[0].profilePic,alt:"".concat(e.users[0].username,"'s profile pic")})}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsx)("span",{className:"username",children:e.users[0].username}),Object(L.jsxs)("div",{className:"message",children:[Object(L.jsx)("div",{children:null===(t=e.lastMessage)||void 0===t?void 0:t.message}),e.lastUpdated&&Object(L.jsxs)("span",{children:["\u2022 ",m(Object(se.a)(new Date(e.lastUpdated+"Z")))]})]})]})]},e.id)},e.id)}))})]})}),Object(L.jsx)(x.Route,{path:"/direct/t/:roomID",children:Object(L.jsx)(pe,{roomID:e})})]})})]}):Object(L.jsxs)("div",{className:"inbox-window outlined",children:[d&&Object(L.jsx)(ne,{title:"New Message",users:n,closeFollowListWindow:u,newMessage:!0}),Object(L.jsxs)("div",{className:"container",children:[Object(L.jsxs)("div",{className:"recent-chats left",children:[Object(L.jsxs)("header",{children:[t.username,Object(L.jsx)("button",{className:"icon",onClick:()=>j(!0),children:Object(L.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fillRule:"evenodd",clipRule:"evenodd",children:Object(L.jsx)("path",{d:"M8.071 21.586l-7.071 1.414 1.414-7.071 14.929-14.929 5.657 5.657-14.929 14.929zm-.493-.921l-4.243-4.243-1.06 5.303 5.303-1.06zm9.765-18.251l-13.3 13.301 4.242 4.242 13.301-13.3-4.243-4.243z"})})})]}),Object(L.jsx)("ul",{children:l.sort(((e,t)=>new Date(t.lastUpdated)-new Date(e.lastUpdated))).map((e=>{var t;return Object(L.jsx)(o.c,{to:"/direct/t/".concat(e.id),activeClassName:"selected",children:Object(L.jsxs)("li",{children:[Object(L.jsx)("span",{className:"profile-pic",children:Object(L.jsx)("img",{src:e.users[0].profilePic,alt:"".concat(e.users[0].username,"'s profile pic")})}),Object(L.jsxs)("div",{className:"info",children:[Object(L.jsx)("span",{className:"username",children:e.users[0].username}),Object(L.jsxs)("div",{className:"message",children:[Object(L.jsx)("div",{children:null===(t=e.lastMessage)||void 0===t?void 0:t.message}),e.lastUpdated&&Object(L.jsxs)("span",{children:["\u2022 ",m(Object(se.a)(new Date(e.lastUpdated)))]})]})]})]},e.id)},e.id)}))})]}),Object(L.jsx)("div",{className:"chat-window right",children:Object(L.jsxs)(x.Switch,{children:[Object(L.jsx)(x.Route,{exact:!0,path:"/direct/inbox",children:Object(L.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"0.75rem"},children:[Object(L.jsx)("div",{style:{height:175},children:Object(L.jsx)("img",{src:fe,alt:"Send a message"})}),Object(L.jsx)("span",{style:{fontWeight:500,fontSize:"1.25em"},children:"Your Messages"}),Object(L.jsx)("span",{style:{color:"#8e8e8e",fontSize:"0.95em"},children:"Send private photos and messages to a friend or group."}),Object(L.jsx)("button",{style:{width:"initial"},onClick:()=>j(!0),children:"Send Message"})]})}),Object(L.jsx)(x.Route,{path:"/direct/t/:roomID",children:Object(L.jsx)(pe,{roomID:e})})]})})]})]}):null};s(399);var ge=()=>{const e=Object(i.b)(),t=Object(Y.useHistory)(),s=Object(x.useLocation)(),[a,n]=Object(c.useState)(!0),r=Object(i.c)((e=>e.currentUser)),o=Object(i.c)((e=>e.loading)),l=Object(i.c)((e=>e.snackbar));l.handleClose=()=>e({type:"CLOSE_SNACKBAR"}),Object(c.useEffect)((()=>{const e=s.pathname;n("/create/style"!==e)}),[s.pathname]);return Object(c.useEffect)((()=>{const t=localStorage.getItem("token");if(null!==t){const s=N.a.decode(t);e(g(s))}}),[e]),Object(c.useEffect)((()=>{if(localStorage.token){const s=setInterval((async()=>{try{await B(e,t)}catch(s){s.message.includes("Failed to fetch")&&e(y("Server is down.","error"))}}),24e4);return()=>clearInterval(s)}}),[e,t]),Object(L.jsxs)("div",{className:"App",style:a?{paddingTop:"75px"}:null,children:[a?Object(L.jsx)(M,{}):null,o?Object(L.jsx)(x.Route,{path:"/",component:Q}):null,Object(L.jsxs)(x.Switch,{children:[Object(L.jsx)(x.Route,{exact:!0,path:"/",children:r?Object(L.jsx)(Ae,{}):Object(L.jsx)(J,{})}),Object(L.jsx)(x.Route,{exact:!0,path:"/accounts/email-signup",component:Z}),Object(L.jsx)(x.Route,{exact:!0,path:"/accounts/password/reset",component:X}),Object(L.jsx)(x.Route,{path:"/accounts/verify",component:K}),Object(L.jsx)(x.Route,{exact:!0,path:"/accounts/edit",component:$}),Object(L.jsx)(x.Route,{exact:!0,path:"/accounts/password/change",component:$}),Object(L.jsx)(x.Route,{exact:!0,path:"/direct/inbox",component:ve}),Object(L.jsx)(x.Route,{exact:!0,path:"/direct/t/:roomID",component:ve}),Object(L.jsx)(x.Route,{exact:!0,path:"/:username",component:ue}),Object(L.jsx)(x.Route,{exact:!0,path:"/:username/saved",component:ue}),Object(L.jsx)(x.Route,{exact:!0,path:"/create/style",component:be}),Object(L.jsx)(x.Route,{exact:!0,path:"/p/:postID",component:Oe}),Object(L.jsx)(x.Route,{path:"/",component:de})]}),Object(L.jsx)(p.a,{open:l.open,message:l.message,autoHideDuration:5e3,onClose:l.handleClose,anchorOrigin:{vertical:"bottom",horizontal:"center"},TransitionComponent:f.a,className:"snackbar",sx:{"& .MuiAlert-message":{fontWeight:"bold"},"& .MuiAlert-action":{paddingLeft:"4px"}},children:Object(L.jsx)(v.a,{onClose:l.handleClose,severity:l.severity,icon:!1,children:l.message})})]})};s(400);r.a.render(Object(L.jsx)(o.a,{children:Object(L.jsx)(i.a,{store:O,children:Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(ge,{})})})}),document.getElementById("root"))}},[[401,1,2]]]);
//# sourceMappingURL=main.77b503e4.chunk.js.map